# StickyBoard 要件定義（確定版）

## 1. アプリ概要

StickyBoard は、個人向けのボードアプリです。
ボードの中に「付箋」と「エリア（枠）」を配置して、作業や思考を視覚的に整理します。

- 付箋：本文・背景色・期限（任意）
- エリア：枠線で囲う背景オブジェクト（タイトル付き）
- 付箋・エリアは自由配置（ドラッグ＆ドロップ）
- 期限を過ぎた付箋は通知を生成（アプリ内通知のみ）

## 2. 技術スタック（固定）

- Backend: Laravel
- Frontend: React + TypeScript
- CSS: Tailwind CSS
- DB: PostgreSQL
- Web: Apache
- Queue: Redis（キュー実行）。通知作成や画像生成
- 通知: アプリ内通知のみ（メール送信は行わない）。laravelのScheduler を使って期限超過を検知する
- 開発: Docker（docker compose） docker-compose.yml に name:sticky_board を記載

導入が確定している（導入時期は別途手順に従う）

- Laravel Boost
- Laravel Pint
- Laravel Horizon
- Laravel Telescope
- ESLint MCP
- Playwright MCP

## 3. 画面一覧（計7画面）

1. ログイン
2. ボード一覧
3. ボード新規作成
4. ボード編集
5. ボード詳細
6. 通知一覧
7. プロフィール編集

※ボード新規作成/編集は同一のポップアップ画面だが画面計上としては別で扱う

## 4. 認証・ユーザー

### 4.1 認証

- Googleログイン（OAuth）を使用する
- ログイン成功後は「ボード一覧」へ遷移

### 4.2 ヘッダー（ログイン後共通）

- 左：
  - StickyBoardと表示し、押下するとボード一覧画面に遷移する
  - `{表示名}さん ようこそ！`（Google表示名を初期表示）
- 右：ユーザーアイコン
  - 未読通知がある場合、アイコン右上に赤文字で「！」を表示
  - アイコン押下でメニュー表示：
    - プロフィール編集
    - 通知一覧　右端に未読件数バッジを表示（赤丸 + 件数）
    - ログアウト

## 5. 共通UI/挙動

### 5.1 確認ポップアップ（共通）

- 作成/更新/削除は、必ず「確認ポップアップ」を経由する
- 表示内容：
  - 実行内容メッセージ
  - キャンセルボタン
  - 実行ボタン

### 5.2 トースト（共通）

- 実行後、成功/失敗のトーストを表示
- 3〜5秒で自動的に消える

## 6. 各画面要件

### 6.1 ログイン

- Googleでログインボタンのみ
- ログイン後はボード一覧へ

### 6.2 ボード一覧

- カード表示のみ
- 無限スクロール（ページングUIなし）
- カード内に「キャンバス内容のサムネイル」を表示
  - 作成直後は真っ白
  - 付箋やエリアが配置されると、その状態を反映したサムネになる
- カード内のサムネイルの下に「タイトル、説明、更新日」を表示
- ボードカードクリックでボード詳細へ遷移
- ボード削除
  - カード内の削除アイコン押下 → 確認ポップアップ → 削除 → トースト
- ボード新規作成
  - ボード新規作成画面へ遷移

### 6.3 ボード新規作成

- 入力：タイトル、説明のみ
- 作成：確認ポップアップ → 作成 → トースト
- 作成後はボード一覧へ戻り、作成したボードが反映されている

### 6.4 ボード編集

- ボード新規作成と同じUI（タイトル/説明）
- 更新：確認ポップアップ → 更新 → トースト
- 遷移元：ボード詳細から遷移　
  - 選択したボードのタイトルと説明が初期値で設定されている

### 6.5 ボード詳細

- ボード上に「付箋」「エリア」を配置し編集する画面。
- ボード全体の拡大、縮小が可能

#### 6.5.1 付箋

- CRUD：作成、編集、削除（物理削除）
- 内容：
  - 本文（テキスト）
  - 背景色（複数色：例 ピンク/黄/緑/青。黒文字が読める彩度）
  - 期限（任意）
- 操作：
  - ボード上でドラッグ＆ドロップ移動
  - 付箋クリックで選択
    - 下部アコーディオンが「付箋」側に自動選択される
    - 選択した付箋の本文・背景色・期限が初期値として表示され、即編集できる

#### 6.5.2 期限とハイライト

- 期限入力は任意
- 期限を入力した付箋は、期限時刻を過ぎたタイミングで通知を生成する
- 期限を超過している付箋はボード上でハイライト表示する
  - 通知一覧から遷移してきた場合に対象を識別できること
  - 通知一覧から遷移していない場合でも、期限超過の付箋はハイライトされる

#### 6.5.3 エリア（枠）

- 目的：付箋のまとまりを視覚的にグルーピングする
- 表示：
  - 枠線（背景色なし）
  - 枠線の太さは固定（まずは1種類）
  - タイトルは枠の左上に固定表示
- 操作：
  - クリックで選択
  - ドラッグで移動
  - 端のドラッグでリサイズ

#### 6.5.4 下部アコーディオン（開閉可能）

- 画面下部にアコーディオン（開閉可能）を配置
- トグルで「付箋メニュー」と「エリアメニュー」を切替
- 新規作成時は下部アコーディオンでトグルを切り替えて登録する
  - 付箋作成：付箋メニュー側
  - エリア作成：エリアメニュー側
- 選択連動：
  - 付箋を選択した場合 → 付箋メニューが自動選択され編集、削除能
  - エリアを選択した場合 → エリアメニューが自動選択されタイトル編集、削除などが可能

### 6.6 通知一覧

- リスト形式
- 無限スクロール
- 未読：背景白
- 既読：背景グレー
- 通知の対象：
  - 期限を超過した付箋について通知が生成される
- 画面からボード詳細へ遷移でき、該当付箋（期限超過ハイライト）を識別できる

### 6.7 プロフィール編集

- 「プロフィール編集」画面として、初期から編集フォームを表示
- 更新ボタンは常時表示
- 更新は確認ポップアップを経由し、成功/失敗トーストを表示
- 編集対象：
  - 表示名
  - アイコン画像（アップロード）
- アイコン画像の画像処理は Queue で非同期化する

## 7. 通知仕様（詳細）

- 通知はアプリ内通知のみ（メール送信なし）
- 通知生成タイミング：
  - 付箋に期限が入力されている場合、期限時刻を過ぎた段階で通知を生成
  - Scheduler で検知
- 表示：
  - アプリを開いている場合、右下にスナック形式で表示
  - 通知一覧にも蓄積する
- 未読管理：
  - 通知一覧で既読化
  - ヘッダーの未読バッジに件数反映

通知検知方式：

- ポーリング方式を採用する(react)
